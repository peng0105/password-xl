import{u as F,a as k,Q as x,p as i}from"./index-VZkZ-gPx.js";import{E}from"./exceljs-B9bSeXl2.js";import{a3 as y}from"./vendor-BvEI7uIN.js";import{E as _}from"./element-plus-DNQbW8zx.js";import{d as C}from"./@vue-PmY8Mkr0.js";import"./cos-js-sdk-v5-WX9VGj_f.js";import"./ali-oss-CN0NZiD5.js";import"./@element-plus-CuK1irWX.js";const A=C({__name:"ExportExcel",setup(S,{expose:u}){const l=F(),p=k(),d=["名称","地址","用户名","密码","标签","备注","创建时间","收藏","自定义信息"],m=async e=>{if(e){await n(e);return}p.verifyPasswordRef.getAndVerify(o=>l.passwordManager.verifyPassword(o)).then(()=>{n(e)})},n=async e=>{const o=new E.Workbook,t=o.addWorksheet("Sheet1");t.addRow(d),e||l.allPasswordArray.map(s=>{let f="";s.labels&&s.labels.length&&(f=x(s.labels));let g=i(s.addTime,"YYYY-MM-DD HH:mm:ss"),c="";if(s.customFields&&s.customFields.length)for(let r=0;r<s.customFields.length;r++)c+=s.customFields[r].key+"："+s.customFields[r].val,r!==s.customFields.length-1&&(c+=`\r
`);return[s.title,s.address,s.username,s.password,f,s.remark,g,s.favorite?"是":"否",c]}).forEach(s=>{t.addRow(s)}),t.getRow(1).eachCell((a,s)=>{switch(a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"00B0F0"}},a.font={bold:!0,color:{argb:"FFFFFF"}},s){case 1:t.getColumn(s).width=20;break;case 2:t.getColumn(s).width=30;break;case 3:case 4:case 5:case 6:case 7:t.getColumn(s).width=20;break;case 8:t.getColumn(s).width=10;break;case 9:t.getColumn(s).width=20;break}});const w=await o.xlsx.writeBuffer(),b=new Blob([w],{type:"application/octet-stream"}),h=e?"密码导入模板.xlsx":"密码导出_"+i(Date.now(),"YYYY-MM-DD HH:mm:ss")+".xlsx";y.saveAs(b,h),e||_.success({title:"密码导出成功",message:"请注意密码安全"})};return u({exportExcel:m}),(e,o)=>null}});export{A as default};
